<div class="admin-report-list-container" *ngIf="reports$ | async as reports">
  <div class="report-list-header">
  <!-- Đã bỏ nút cập nhật -->
  </div>
  
  <div class="message-bar-wrapper">
    <div *ngIf="errorMsg" class="error-bar message-bar">{{ errorMsg }}</div>
    <div *ngIf="successMsg" class="success-bar message-bar">{{ successMsg }}</div>
  </div>

  <div class="search-bar" style="position:relative;width:100%;max-width:none;margin:0 auto 18px auto;">
    <input 
      type="text" 
      [(ngModel)]="searchText" 
      (input)="onSearchInputChange()"
      placeholder="Tìm kiếm báo cáo..."
      class="search-input"
      style="width:100%;padding:16px 48px 16px 20px;border-radius:12px;border:2px solid #e9ecef;font-size:1rem;background:#fff;transition:all 0.3s ease;box-shadow:none;outline:none;"
    >
    <span class="search-icon" style="position:absolute;right:22px;top:50%;transform:translateY(-50%);color:#388e3c;font-size:1.25em;pointer-events:none;background:transparent;z-index:2;">
      <i class="fas fa-search"></i>
    </span>
  </div>

  <table class="report-table">
    <thead>
      <tr>
        <th>STT</th>
        <th (click)="sortBy('title')">Tiêu đề</th>
        <th (click)="sortBy('reporterName')">Người báo cáo</th>
        <th (click)="sortBy('createdAt')">Ngày tạo</th>
        <th (click)="sortBy('status')">Trạng thái</th>
        <th>Hành động</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let report of reports; let i = index" (click)="viewDetail(report)" class="clickable-row">
        <td>{{ i + 1 + (pageNo * 10) }}</td>
        <td>
          <span class="report-title">{{ report.reason }}</span>
        </td>
        <td>{{ report.reporterName }}</td>
        <td>{{ report.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
        <td>
          <span class="status-badge status-inline" [ngClass]="getStatusClass(report.status)">
            {{ getStatusText(report.status) }}
          </span>
        </td>
        <td>
          <div class="action-buttons" (click)="$event.stopPropagation()">
            <button class="btn btn-outline claim-btn"
                    [disabled]="['CLAIMED','APPROVED','REJECTED'].includes(report.status)"
                    *ngIf="getStatusText(report.status)"
                    (click)="claimReport(report.reportId)"
                    title="Nhận xử lý báo cáo">
              <i class="fas fa-user-check"></i>
              Nhận xử lý
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination-bar" *ngIf="reports.length > 0">
    <button (click)="prevPage()" [disabled]="pageNo === 0">&lt; Trước</button>
    <span>Trang {{ pageNo + 1 }} / {{ totalPages }}</span>
    <button (click)="nextPage()" [disabled]="pageNo + 1 >= totalPages">Sau &gt;</button>
  </div>

  <div *ngIf="loading" class="loading-bar">Đang tải...</div>
  
  <div *ngIf="!loading && reports.length === 0" class="empty-state">
    <p>Không có báo cáo nào.</p>
  </div>
</div>