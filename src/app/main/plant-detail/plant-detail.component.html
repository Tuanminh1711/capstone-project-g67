<app-top-navigator></app-top-navigator>

<div class="plant-detail-container">
  <div class="plant-detail-content">

    <!-- Authentication required message -->
    <div *ngIf="requiresAuth" class="auth-required-msg">
      <div class="auth-card">
        <h3>YÃªu cáº§u Ä‘Äƒng nháº­p</h3>
        <p>Äá»ƒ xem thÃ´ng tin chi tiáº¿t cá»§a cÃ¢y nÃ y, báº¡n cáº§n Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng.</p>
        <div class="auth-actions">
          <button class="login-btn" (click)="goToLogin()">ÄÄƒng nháº­p</button>
          <button class="back-to-list-btn" (click)="goBack()">Quay láº¡i danh sÃ¡ch</button>
        </div>
      </div>
    </div>

    <!-- Error -->
    <div *ngIf="!requiresAuth && error" class="status-msg error">
      {{ error }}
      <button class="retry-btn" (click)="reloadPlantDetail()">Thá»­ láº¡i</button>
    </div>

    <!-- Plant detail content -->
    <div *ngIf="plant" class="plant-detail">
      <!-- Limited info notice (if using public data) -->
      <div *ngIf="isLimitedInfo" class="limited-info-notice">
        <div class="notice-content">
          <span>â„¹ï¸ Äang hiá»ƒn thá»‹ thÃ´ng tin cÆ¡ báº£n. <a (click)="openLoginDialog(); $event.stopPropagation(); $event.preventDefault()" class="login-link">ÄÄƒng nháº­p</a> Ä‘á»ƒ xem thÃ´ng tin chi tiáº¿t Ä‘áº§y Ä‘á»§.</span>
        </div>
      </div>
      <!-- Image gallery -->
      <div class="plant-images">
        <div class="main-image">
          <img 
            [src]="selectedImage || plant.imageUrls[0] || '/assets/image/logo.png'" 
            [alt]="plant.commonName"
            class="main-img"
          />
        </div>
        <div class="image-thumbnails" *ngIf="plant.imageUrls && plant.imageUrls.length > 1">
          <img 
            *ngFor="let imageUrl of plant.imageUrls" 
            [src]="imageUrl"
            [alt]="plant.commonName"
            class="thumbnail"
            [class.active]="selectedImage === imageUrl"
            (click)="selectImage(imageUrl)"
          />
        </div>
      </div>

      <!-- Plant information -->
      <div class="plant-info">
        <div class="plant-header">
          <h1 class="plant-name">{{ plant.commonName }}</h1>
          <p class="plant-scientific">({{ plant.scientificName }})</p>
          <span class="plant-category">{{ plant.categoryName }}</span>
          
          <!-- Add to collection button -->
          <div class="action-buttons">
            <button 
              class="add-to-collection-btn"
              (click)="addToCollection()"
              title="ThÃªm cÃ¢y nÃ y vÃ o bá»™ sÆ°u táº­p cá»§a báº¡n"
            >
              ğŸŒ± ThÃªm vÃ o bá»™ sÆ°u táº­p
            </button>
          </div>
        </div>

        <div class="plant-description">
          <h3>MÃ´ táº£</h3>
          <p>{{ plant.description }}</p>
        </div>

        <div class="plant-care-info">
          <h3>ThÃ´ng tin chÄƒm sÃ³c</h3>
          <div class="care-grid">
            <div class="care-item">
              <span class="care-label">Ãnh sÃ¡ng:</span>
              <span class="care-value">{{ translateLightRequirement(plant.lightRequirement) }}</span>
            </div>
            <div class="care-item">
              <span class="care-label">NÆ°á»›c:</span>
              <span class="care-value">{{ translateWaterRequirement(plant.waterRequirement) }}</span>
            </div>
            <div class="care-item">
              <span class="care-label">Äá»™ khÃ³:</span>
              <span class="care-value">{{ translateCareDifficulty(plant.careDifficulty) }}</span>
            </div>
            <div class="care-item">
              <span class="care-label">Vá»‹ trÃ­ phÃ¹ há»£p:</span>
              <span class="care-value">{{ plant.suitableLocation || 'ChÆ°a cÃ³ thÃ´ng tin' }}</span>
            </div>
          </div>
        </div>

        <div class="plant-care-instructions" *ngIf="plant.careInstructions && !isLimitedInfo">
          <h3>HÆ°á»›ng dáº«n chÄƒm sÃ³c</h3>
          <p>{{ plant.careInstructions }}</p>
        </div>

        <div class="plant-diseases" *ngIf="plant.commonDiseases && !isLimitedInfo">
          <h3>Bá»‡nh thÆ°á»ng gáº·p</h3>
          <p>{{ plant.commonDiseases }}</p>
        </div>



        <!-- Limited info message for care instructions -->
        <div *ngIf="isLimitedInfo" class="limited-content-msg">
          <div class="limited-section">
            <h3>HÆ°á»›ng dáº«n chÄƒm sÃ³c chi tiáº¿t</h3>
            <p class="locked-content">
              ğŸ”’ Ná»™i dung nÃ y yÃªu cáº§u Ä‘Äƒng nháº­p Ä‘á»ƒ xem
            </p>
          </div>
          <div class="limited-section">
            <h3>ThÃ´ng tin bá»‡nh thÆ°á»ng gáº·p</h3>
            <p class="locked-content">
              ğŸ”’ Ná»™i dung nÃ y yÃªu cáº§u Ä‘Äƒng nháº­p Ä‘á»ƒ xem
            </p>
          </div>
        </div>

        <div class="plant-meta">
          <span class="status" [class]="'status-' + plant.status.toLowerCase()">
            Tráº¡ng thÃ¡i: {{ translatePlantStatus(plant.status) }}
          </span>
          <span class="created-date" *ngIf="plant.createdAt">
            NgÃ y táº¡o: {{ formatDate(plant.createdAt) }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
