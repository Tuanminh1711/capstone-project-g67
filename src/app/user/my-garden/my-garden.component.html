<app-top-navigator></app-top-navigator>

<div class="garden-collection">
  <h2 class="collection-title">KHU VÆ¯á»œN Cá»¦A TÃ”I</h2>
  
  <div class="layout-switcher">
    <button [class.active]="layout==='grid'" (click)="layout='grid'">Báº¢NG</button>
    <button [class.active]="layout==='list'" (click)="layout='list'">DANH SÃCH</button>
  </div>
  
  <div class="filter-switcher">
    <button [class.active]="filter==='all'" (click)="filter='all'">Táº¤T Cáº¢</button>
    <button [class.active]="filter==='reminder'" (click)="filter='reminder'">CÃ“ NHáº®C NHá»</button>
    <button [class.active]="filter==='no-reminder'" (click)="filter='no-reminder'">KHÃ”NG NHáº®C NHá»</button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-message">
    <p>Äang táº£i bá»™ sÆ°u táº­p cá»§a báº¡n...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadUserPlants()">Thá»­ láº¡i</button>
  </div>

  <!-- Plants display -->
  <div *ngIf="!loading && !error && userPlants.length > 0">
    <!-- Grid layout -->
    <div *ngIf="layout==='grid'">
      <div class="plant-list">
        <div class="plant-card" *ngFor="let userPlant of filteredPlants">
          <div class="plant-image">
            <img 
              [src]="userPlant.plant.imageUrls[0] || '/assets/image/default-plant.png'" 
              [alt]="userPlant.nickname"
              onerror="this.src='/assets/image/default-plant.png'"
              (click)="viewPlantDetail(userPlant.plant.id)"
            />
          </div>
          <div class="plant-info">
            <div class="plant-row plant-row-title">
              <h3>{{ userPlant.nickname }}</h3>
            </div>
            <div class="plant-row plant-row-desc">
              <p>{{ userPlant.plant.commonName || userPlant.plant.scientificName }}</p>
            </div>
            <div class="plant-row plant-row-location">
              <p>ğŸ“ {{ userPlant.locationInHouse }}</p>
            </div>
            <div class="plant-row plant-row-tags">
              <div class="plant-tags">
                <span class="plant-tag">ğŸ’¡ {{ translateLightRequirement(userPlant.plant.lightRequirement) }}</span>
                <span class="plant-tag">ğŸ’§ {{ translateWaterRequirement(userPlant.plant.waterRequirement) }}</span>
                <span class="plant-tag" *ngIf="userPlant.reminderEnabled">ğŸ”” Nháº¯c nhá»Ÿ</span>
              </div>
            </div>
            <div class="plant-actions">
              <button 
                class="view-btn"
                (click)="viewPlantDetail(userPlant.plant.id)"
                title="Xem chi tiáº¿t"
              >
                ğŸ‘ï¸ Chi tiáº¿t
              </button>
              <button 
                class="remove-btn"
                (click)="removePlantFromCollection(userPlant.id)"
                title="XÃ³a khá»i bá»™ sÆ°u táº­p"
              >
                ğŸ—‘ï¸ XÃ³a
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- List layout -->
    <div *ngIf="layout==='list'">
      <div class="plant-list-listview">
        <div class="plant-list-item" *ngFor="let userPlant of filteredPlants">
          <div class="plant-list-img">
            <img 
              [src]="userPlant.plant.imageUrls[0] || '/assets/image/default-plant.png'" 
              [alt]="userPlant.nickname"
              onerror="this.src='/assets/image/default-plant.png'"
              (click)="viewPlantDetail(userPlant.plant.id)"
            />
          </div>
          <div class="plant-list-info">
            <div class="plant-row plant-row-title">
              <h3>{{ userPlant.nickname }}</h3>
            </div>
            <div class="plant-row plant-row-desc">
              <p>{{ userPlant.plant.commonName || userPlant.plant.scientificName }}</p>
            </div>
            <div class="plant-row plant-row-location">
              <p>ğŸ“ {{ userPlant.locationInHouse }} | ğŸ“… Tá»« {{ formatDate(userPlant.plantingDate) }}</p>
            </div>
            <div class="plant-row plant-row-tags">
              <div class="plant-tags">
                <span class="plant-tag">ğŸ’¡ {{ translateLightRequirement(userPlant.plant.lightRequirement) }}</span>
                <span class="plant-tag">ğŸ’§ {{ translateWaterRequirement(userPlant.plant.waterRequirement) }}</span>
                <span class="plant-tag" *ngIf="userPlant.reminderEnabled">ğŸ”” Nháº¯c nhá»Ÿ</span>
              </div>
            </div>
            <div class="plant-actions">
              <button 
                class="view-btn"
                (click)="viewPlantDetail(userPlant.plant.id)"
                title="Xem chi tiáº¿t"
              >
                ğŸ‘ï¸ Chi tiáº¿t
              </button>
              <button 
                class="remove-btn"
                (click)="removePlantFromCollection(userPlant.id)"
                title="XÃ³a khá»i bá»™ sÆ°u táº­p"
              >
                ğŸ—‘ï¸ XÃ³a
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && !error && userPlants.length === 0" class="empty-list">
    <div class="empty-content">
      <div class="empty-icon">ğŸŒ¿</div>
      <h3>ChÆ°a cÃ³ cÃ¢y nÃ o trong bá»™ sÆ°u táº­p</h3>
      <p>HÃ£y báº¯t Ä‘áº§u thÃªm nhá»¯ng cÃ¢y yÃªu thÃ­ch vÃ o bá»™ sÆ°u táº­p cá»§a báº¡n!</p>
      <button class="browse-plants-btn" (click)="router.navigate(['/plant-info'])">
        KhÃ¡m phÃ¡ cÃ¢y cáº£nh
      </button>
    </div>
  </div>
</div>
