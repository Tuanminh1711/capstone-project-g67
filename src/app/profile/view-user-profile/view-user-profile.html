<!-- View User Profile: Avatar on top, info below, compact layout -->
<app-top-navigator></app-top-navigator>
<div class="view-profile-page">
  <!-- Loading Indicator -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>ƒêang t·∫£i th√¥ng tin h·ªì s∆°...</p>
  </div>

  <!-- Error Display -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p class="error-message">{{ error }}</p>
    <button class="retry-btn" (click)="retryLoadProfile()">Th·ª≠ l·∫°i</button>
    <button class="retry-btn" (click)="checkAuthState()" style="margin-left: 10px; background: #2196F3;">Debug Auth</button>
  </div>

  <!-- Profile Content -->
  <div *ngIf="!loading && !error" class="view-profile-card split-layout">
    <div class="left-section">
      <div class="profile-avatar">
        <ng-container *ngIf="userProfile; else avatarSkeleton">
          <img *ngIf="userProfile.avatar" [src]="userProfile.avatar" alt="avatar" />
          <span *ngIf="!userProfile.avatar" class="avatar-placeholder">{{ userProfile.fullName ? userProfile.fullName.charAt(0) : 'üë§' }}</span>
        </ng-container>
        <ng-template #avatarSkeleton>
          <div class="avatar-skeleton"></div>
        </ng-template>
      </div>
    </div>
    <div class="right-section">
      <h2 class="profile-title">H·ªí S∆† NG∆Ø·ªúI D√ôNG</h2>
      <ng-container *ngIf="userProfile; else skeletonFields">
        <div class="info">
          <p><strong>ID:</strong> {{ userProfile.id }}</p>
          <p><strong>T√™n ƒëƒÉng nh·∫≠p:</strong> {{ userProfile.username }}</p>
          <p><strong>H·ªç t√™n:</strong> {{ userProfile.fullName }}</p>
          <p><strong>Email:</strong> {{ userProfile.email }}</p>
          <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> {{ userProfile.phoneNumber }}</p>
          <p><strong>Gi·ªõi t√≠nh:</strong> {{ userProfile.gender || '-' }}</p>
          <p><strong>M√¥i tr∆∞·ªùng s·ªëng:</strong> {{ userProfile.livingEnvironment || '-' }}</p>
          <a class="edit-profile-btn" routerLink="/edit-profile">Ch·ªânh s·ª≠a h·ªì s∆°</a>
        </div>
      </ng-container>
      <ng-template #skeletonFields>
        <div class="info">
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
          <p><span class="skeleton skeleton-text"></span></p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
