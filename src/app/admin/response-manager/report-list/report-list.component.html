<app-admin-layout>
  <div class="admin-report-list-container" *ngIf="reports$ | async as reports">
    <div class="report-list-header">
      <h2>Danh s√°ch b√°o c√°o vi ph·∫°m</h2>
      <button class="reload-btn" (click)="reloadReports()" title="T·∫£i l·∫°i danh s√°ch">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;">
          <path d="M4 10a6 6 0 1 1 6 6" stroke="#388e3c" stroke-width="2" fill="none"/>
          <path d="M4 10V6M4 10h4" stroke="#388e3c" stroke-width="2" fill="none"/>
        </svg>
        C·∫≠p nh·∫≠t
      </button>
    </div>
    
    <div class="message-bar-wrapper">
      <div *ngIf="errorMsg" class="error-bar message-bar">{{ errorMsg }}</div>
      <div *ngIf="successMsg" class="success-bar message-bar">{{ successMsg }}</div>
        </div>

        <div class="search-bar">
          <input 
            type="text" 
            [(ngModel)]="searchText" 
            (input)="onSearchInputChange()"
            placeholder="T√¨m ki·∫øm b√°o c√°o..."
            class="search-input"
          >
          <button (click)="onSearch()" class="search-btn">T√¨m ki·∫øm</button>
        </div>

        <table class="report-table">
          <thead>
            <tr>
              <th (click)="sortBy('id')">ID</th>
              <th (click)="sortBy('title')">Ti√™u ƒë·ªÅ</th>
              <th (click)="sortBy('reporterName')">Ng∆∞·ªùi b√°o c√°o</th>
              <th (click)="sortBy('createdAt')">Ng√†y t·∫°o</th>
              <th (click)="sortBy('status')">Tr·∫°ng th√°i</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reports">
              <td>{{ report.id }}</td>
              <td>
                <a (click)="viewDetail(report)" class="report-link">{{ report.title }}</a>
              </td>
              <td>{{ report.reporterName }}</td>
              <td>{{ report.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(report.status)">
                  {{ getStatusText(report.status) }}
                </span>
              </td>
              <td>
                <button class="view-btn" (click)="viewDetail(report)" title="Xem chi ti·∫øt">
                  üëÅ Xem
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="pagination-bar" *ngIf="reports.length > 0">
          <button (click)="prevPage()" [disabled]="pageNo === 0">&lt; Tr∆∞·ªõc</button>
          <span>Trang {{ pageNo + 1 }} / {{ totalPages }}</span>
          <button (click)="nextPage()" [disabled]="pageNo + 1 >= totalPages">Sau &gt;</button>
        </div>

        <div *ngIf="loading" class="loading-bar">ƒêang t·∫£i...</div>
        
        <div *ngIf="!loading && reports.length === 0" class="empty-state">
          <p>Kh√¥ng c√≥ b√°o c√°o n√†o.</p>
        </div>
      </div>
</app-admin-layout>