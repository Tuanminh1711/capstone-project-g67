<app-admin-layout>
  <div class="admin-plant-list-container">
    <h2>Danh sách cây trồng</h2>
    <div class="search-bar">
      <input type="text" [(ngModel)]="searchText" (input)="onSearchInputChange()" placeholder="Tìm kiếm tên, danh mục..." />
      <button (click)="onSearch()">Tìm kiếm</button>
    </div>
    <div *ngIf="errorMsg" class="error-bar">{{ errorMsg }}</div>
    <div *ngIf="loading" class="loading-bar">Đang tải...</div>
    <table class="plant-table" *ngIf="!loading && (plants$ | async)?.length">
      <thead>
        <tr>
          <th>Ảnh</th>
          <th>Tên thường gọi</th>
          <th>Tên khoa học</th>
          <th>Danh mục</th>
          <th>Mô tả</th>
          <th>Độ khó</th>
          <th>Ánh sáng</th>
          <th>Nước</th>
          <th>Vị trí</th>
          <th>Bệnh thường gặp</th>
          <th>Trạng thái</th>
          <th>Ngày tạo</th>
          <th>Hành động</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let plant of plants$ | async">
          <td><img [src]="plant.imageUrls[0]" alt="plant" width="60" height="60" style="object-fit:cover;border-radius:8px;" /></td>
          <td>{{ plant.commonName }}</td>
          <td>{{ plant.scientificName }}</td>
          <td>{{ plant.categoryName }}</td>
          <td>{{ plant.description }}</td>
          <td>{{ plant.careDifficulty }}</td>
          <td>{{ plant.lightRequirement }}</td>
          <td>{{ plant.waterRequirement }}</td>
          <td>{{ plant.suitableLocation }}</td>
          <td>{{ plant.commonDiseases }}</td>
          <td>{{ plant.status }}</td>
          <td>{{ plant.createdAt || '-' }}</td>
          <td>
            <button (click)="editPlant(plant)">Sửa</button>
            <button (click)="deletePlant(plant)">Xóa</button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="pagination-bar" *ngIf="totalPages > 1">
      <button (click)="goToPage(pageNo-1)" [disabled]="pageNo === 0">&lt; Trước</button>
      <span>Trang {{ pageNo + 1 }} / {{ totalPages }}</span>
      <button (click)="goToPage(pageNo+1)" [disabled]="pageNo + 1 >= totalPages">Sau &gt;</button>
    </div>
  </div>
</app-admin-layout>
